In October â€“ November 1812 , Yermolov served in the advance guard under Miloradovich and fought at Vyazma and Krasnyi .