Louis XIV tried to undermine this strategy by refusing to recognize William as king of England , and by giving diplomatic , military and financial support to a series of pretenders to the English throne , all based in France .