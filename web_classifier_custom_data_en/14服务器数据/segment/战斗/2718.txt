In November and December 1655 the Swedish army under Gustaf Otto Stenbock captured all the towns of Royal Prussia except for Gda≈Ñsk , Puck and Malbork . To prevent John Casimir 's return to Poland , Swedish units protected the border with Silesia .